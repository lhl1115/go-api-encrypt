# goencrypt
简体中文 | [English](README-EN.md)

go语言接口加密中间件，给出了gin框架的示例，其他框架可以参考

本项目主要是提供一个加密思路和方法的工程演示，具体的加密方式可以自己实现

go 版本 >= 1.16

## 适用场景
```
当你需要对接口的请求参数进行加密校验时，可以使用这个中间件

主要目的是防止请求参数被篡改，以及简单的爬虫，保证接口安全

当然前端加密并不安全，只是增加了破解的难度，所以这个中间件只是提供了一种思路，具体的加密方式可以自己实现

加密使用的是AES-CBC-Hex，可以自己修改加密方式
```

## 使用限制
```
目前只支持GET和POST请求，其他请求方式会直接通过

GET请求校验的是url中的参数，POST请求校验的是body中json类型的参数

Json参数过于复杂的情况下没有经过测试
```

## 框架支持
[Gin](https://github.com/gin-gonic/gin)
gin框架给出了比较完整的示例，可以直接运行


## 目录结构
```
├── gin     gin框架中间件示例
├── test    测试用例
├── utils   工具函数
```


## 加密过程
```
1. 获取请求参数

2. 将请求参数按照key升序排序

3. 将排序后的请求参数拼接成字符串，如：age13namejack

4. 将时间戳和appsecret拼接到字符串后面

5. 对字符串进行AES加密

6. 设置请求头：timestamp(10位)、signature、appid
```


## 校验过程
```
1. 校验请求头

2. 检查时间戳是否过期

3. 跟上一个步骤一样，将请求参数按照key升序排序后拼接，然后拼接时间戳和appsecret

4. 对字符串进行AES加密后和传来的signature进行比较
```

## 后续计划
- [ ] 支持更多的加密方式
- [ ] 接口防重放
- [ ] 支持更多的请求方式